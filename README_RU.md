# goping

[English](README.md) | Русский

`goping` — это быстрый параллельный сканер ICMP, вдохновлённый `fping` и переписанный на Go. Он сканирует тысячи IPv4/IPv6‑адресов, ведёт подробную статистику по каждому хосту и умеет выводить результаты в текстовом, JSON‑ или Netdata‑совместимом формате.

## Возможности

- **Высокая производительность** — параллельные воркеры с настраиваемыми интервалами позволяют эффективно сканировать даже /16 сети.
- **Гибкий ввод целей** — поддерживаются одиночные адреса, файлы (`-f file`) и генерация адресов по CIDR или диапазону (`-g`, `--generate`).
- **IPv4 и IPv6** — можно принудительно выбрать стек (`-4`/`-6`) или сканировать оба одновременно.
- **Индикация прогресса и отчёты** — прогресс‑бар (`-P`), периодические сводки (`-Q 5`), учёт простоев, вывод JSON/Netdata, накопительные отчёты.
- **Учёт трафика** — флаг `-L/--traffic` показывает количество пакетов и среднюю нагрузку на протяжении сканирования.
- **TCP-режим** — `-y/--tcp-probe` (с `-Y PORT`) позволяет обнаруживать хосты через TCP connect, когда ICMP блокируется (например, в Termux).
- **О локализованные подсказки** — при запуске учитывается системная локаль, также можно переключиться `--lang`/`-l ru`.
- **Практичные флаги** — тихий режим (`-q`), отметки времени, TTL/TOS, reverse DNS, случайный payload, гибкие таймауты/повторы.

## Установка

Нужен Go 1.24+ (см. `go.mod`).

```powershell
# Клонируем репозиторий:
go build -o goping.exe .
# Или ставим в GOPATH/bin:
go install ./...
```

Бинарный файл самодостаточен; для доступа к сырым сокетам в некоторых ОС могут понадобиться права администратора (`sudo`, `setcap cap_net_raw+ep` и т.п.).

## Использование

```powershell
goping [опции] цель [цель...]
```

Быстрый опрос двух хостов:

```powershell
goping -a -q -P -i 1 10.0.0.1 10.0.0.2
```

Сканирование подсети с учётом загрузки:

```powershell
goping -a -q -P -i 1 -L -g 10.0.0.0/24
```

JSON для последующей обработки:

```powershell
goping --json --count 3 example.com
```

Netdata-выгрузка каждые 10 секунд:

```powershell
goping -N -Q 10,cumulative targets.txt
```

## Основные флаги

| Флаг | Описание |
| ---- | -------- |
| `-a`, `--alive` | Печатать живые хосты. |
| `-q`, `--quiet` | Тихий вывод (только список IP при `-a`). |
| `-P`, `--progress` | Показывать прогресс‑бар. |
| `-i`, `--interval` | Глобальный интервал между пакетами. |
| `-p`, `--period` | Интервал между запросами к одному хосту (по умолчанию 1 с). |
| `-c`, `--count` | Количество запросов на хост (0 — пока не ответит). |
| `-g`, `--generate` | Генерация адресов из CIDR/диапазона. |
| `-f`, `--file` | Чтение целей из файла (`-` — stdin). |
| `-J`, `--json` | Вывод структурированных JSON‑событий. |
| `-N`, `--netdata` | Netdata-совместимый вывод. |
| `-L`, `--traffic` | Сводка по трафику (pps/Mbps). |
| `-l LOCALE`, `--lang=LOCALE` | Переключение языка подсказок (`en`/`ru`). |
| `-y`, `--tcp-probe` | TCP connect вместо ICMP. |
| `-Y`, `--tcp-port=PORT` | Порт для TCP-проверок (по умолчанию 80). |
| `-Q`, `--squiet SEC[,cumulative]` | Периодические сводки. |
| `-S`, `--src` | Задать исходный IP. |
| `-t`, `-r` | Таймаут и число повторов. |

Полный список — `goping --help`.

## Разработка

```powershell
gofmt -w .
go build ./...
go test ./...    # при необходимости
```

При внесении изменений:

1. Соблюдайте понятные комментарии/структуру кода.
2. Новые флаги отражайте в `options.go`, `help.go`, README и README_RU.
3. Для поиска по проекту используйте `rg`/`ripgrep` для скорости.

## Лицензия

MIT (см. [LICENSE](LICENSE)).
